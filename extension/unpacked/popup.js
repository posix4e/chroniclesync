import{c as f,j as e,R as x,r as c}from"./assets/client-BVW2ohSn.js";import"./assets/_commonjsHelpers-BosuxZz1.js";function j(){const[s,l]=c.useState(!1),[r,d]=c.useState(""),[u,o]=c.useState("Never"),h=()=>{chrome.windows.create({url:chrome.runtime.getURL("history.html"),type:"popup",width:500,height:600})};c.useEffect(()=>{(async()=>{try{const t=await new Promise(a=>{chrome.storage.sync.get(["clientId","initialized","lastSync"],g=>{a(g)})});if(t.clientId&&d(t.clientId),t.initialized&&l(t.initialized),t.lastSync){const a=new Date(t.lastSync);o(a.toLocaleString())}}catch(t){console.error("Error initializing popup:",t)}})();const i=t=>{t.type==="syncComplete"&&(t.lastSync?o(t.lastSync):o(new Date().toLocaleString()))};return chrome.runtime.onMessage.addListener(i),()=>{chrome.runtime.onMessage.removeListener(i)}},[]);const y=()=>{r&&chrome.storage.sync.set({clientId:r,initialized:!0},()=>{l(!0)})},m=n=>{const i=n.target.value;d(i),chrome.storage.sync.set({clientId:i},()=>{})},p=()=>{chrome.runtime.sendMessage({type:"triggerSync"},n=>{chrome.runtime.lastError?alert("Sync failed: "+chrome.runtime.lastError.message):n&&n.error?alert("Sync failed: "+n.error):n&&n.success?alert(n.message||"Sync successful"):alert("Sync initiated")})},S=()=>{chrome.runtime.openOptionsPage()};return e.jsxs("div",{className:"app",children:[e.jsx("h1",{children:"ChronicleSync"}),e.jsxs("div",{id:"adminLogin",children:[e.jsx("h2",{children:"Admin Login"}),e.jsxs("form",{children:[e.jsx("input",{type:"text",id:"clientId",placeholder:"Client ID",value:r,onChange:m}),s?e.jsx("button",{type:"button",onClick:p,children:"Sync with Server"}):e.jsx("button",{type:"button",onClick:y,children:"Initialize"})]})]}),e.jsxs("div",{id:"status",className:"sync-status",children:["Last sync: ",u]}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{type:"button",onClick:h,children:"View History"}),e.jsx("button",{type:"button",onClick:S,children:"Settings"})]})]})}if(typeof document<"u"){const s=document.getElementById("root");s&&f.createRoot(s).render(e.jsx(x.StrictMode,{children:e.jsx(j,{})}))}
